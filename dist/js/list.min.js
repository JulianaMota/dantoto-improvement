let modal=document.querySelector(".modal"),modalClose=document.querySelector(".modalClose"),deactivatedList=[],arrayOfUsers=[];const userObject={Photo:"-user photo-",Username:"-user name-",Password:"-user password-",Wins:"-wins-",Looses:"-looses-",Rating:"-rating-",Fullname:"-fullname-",Email:"-email-",Telephone:"-telephone-",Address:"-address-",Id:"-id-"};function getJSON(){fetch("https://dantoto-eb44.restdb.io/rest/dantoto-users",{method:"get",headers:{"Content-Type":"application/json; charset=utf-8","x-apikey":"5ce6c77b780a473c8df5cb6d","cache-control":"no-cache"}}).then(e=>e.json()).then(makeObject)}function makeObject(e){e.forEach(e=>{const t=Object.create(userObject);t.photo="https://dantoto-eb44.restdb.io/media/"+e.Photo,t.username=e.Username,t.password=e.Password,t.wins=e.Wins,t.looses=e.Looses,t.rating=e.Rating,t.fullname=e.Fullname,t.email=e.Email,t.telephone=e.Telephone,t.address=e.Address,t.id=e._id,arrayOfUsers.push(t)}),displayUsers(arrayOfUsers)}function displayUsers(e){document.querySelectorAll(".tableRow").forEach(e=>{e.remove()}),e.forEach(e=>{const t=document.querySelector("#template1").content,o=document.querySelector("#template2").content,n=t.cloneNode(!0),r=o.cloneNode(!0);console.log(e.photo),"https://dantoto-eb44.restdb.io/media/"===e.photo||"https://dantoto-eb44.restdb.io/media/undefined"===e.photo?n.querySelector(".photoTable").src="./images/noPhoto.png":n.querySelector(".photoTable").src=e.photo,n.querySelector(".name").textContent=e.username,n.querySelector(".wins").textContent=e.wins,n.querySelector(".looses").textContent=e.looses,n.querySelector(".rating").textContent=e.rating;let a="removeButton"+e.id;n.querySelector(".removeButton").id=a,removeButtonObject=n.querySelector(".removeButton"),removeButtonObject.addEventListener("click",t=>{showWarning(e.id)}),r.querySelector(".warningWrapper").id="warningWrapper"+e.id,n.querySelectorAll(".row").forEach(t=>{t.addEventListener("click",t=>{showModal(e.id),document.querySelector("#deactivateButton").style.display="block"})}),r.querySelectorAll(".warningClose").forEach(t=>{t.addEventListener("click",t=>{hideWarning(e.id)})}),r.querySelectorAll(".deleteButton").forEach(t=>{t.addEventListener("click",t=>{deleteUser(e.id)})}),document.querySelector("#table1").appendChild(n),document.querySelector("#parent2").appendChild(r)})}function showWarning(e){let t="#warningWrapper"+e;document.querySelector(t).style.display="block"}function hideWarning(e){let t="#warningWrapper"+e;document.querySelector(t).style.display="none"}function displayDeactivated(e){e.forEach(e=>{const t=document.querySelector("#template1").content.cloneNode(!0);null!=e.photo&&("https://dantoto-eb44.restdb.io/media/"===e.photo||"https://dantoto-eb44.restdb.io/media/undefined"===e.photo?t.querySelector(".photoTable").src="./images/noPhoto.png":t.querySelector(".photoTable").src=e.photo),t.querySelector(".name").textContent=e.username,t.querySelector(".wins").textContent=e.wins,t.querySelector(".looses").textContent=e.looses,t.querySelector(".rating").textContent=e.rating;let o="removeButton"+e.id;t.querySelector(".removeButton").id=o,removeButtonObject=t.querySelector(".removeButton"),removeButtonObject.addEventListener("click",t=>{showWarning(e.id)}),t.querySelectorAll(".row").forEach(t=>{t.addEventListener("click",t=>{showModal(e.id),document.querySelector("#deactivateButton").style.display="none"})}),document.querySelector("#table2").appendChild(t),document.querySelector("#table2Wrapper").classList.remove("invisible")}),0==e.length&&document.querySelector("#table2Wrapper").classList.add("invisible")}function deleteUser(e){fetch("https://dantoto-eb44.restdb.io/rest/dantoto-users/"+e,{method:"delete",headers:{"Content-Type":"application/json; charset=utf-8","x-apikey":"5ce6c77b780a473c8df5cb6d","cache-control":"no-cache"}}).then(e=>e.json()).then(e=>{});let t=findById(e,arrayOfUsers);t<0?(t=findById(e,deactivatedList),deactivatedList.splice(t,1)):arrayOfUsers.splice(t,1),hideWarning(e),displayUsers(arrayOfUsers),displayDeactivated(deactivatedList)}function findById(e,t){return t.findIndex(t=>t.id===e)}function showModal(e){fetch("https://dantoto-eb44.restdb.io/rest/dantoto-users/"+e,{method:"get",headers:{"Content-Type":"application/json; charset=utf-8","x-apikey":"5ce6c77b780a473c8df5cb6d","cache-control":"no-cache"}}).then(e=>e.json()).then(t=>{modal.style.display="block";let o=document.querySelector(".photoModal"),n=document.querySelector("#Username"),r=document.querySelector("#Fullname"),a=document.querySelector("#Email"),s=document.querySelector("#Telephone"),d=document.querySelector("#Address"),c=document.querySelector("#deactivateButton");console.log(t.Photo),void 0===t.Photo||0===t.Photo.length?o.src="./images/noPhoto.png":o.src="https://dantoto-eb44.restdb.io/media/"+t.Photo,n.textContent=t.Username,r.textContent=t.Fullname,a.textContent=t.Email,s.textContent=t.Telephone,d.textContent=t.Address,modalClose.onclick=function(){hideModal()},c.onclick=function(){deactivateUser(e)}})}function hideModal(){modal.style.display="none"}function deactivateUser(e){let t=findById(e,arrayOfUsers);deactivatedList.push(arrayOfUsers[t]);arrayOfUsers.splice(t,1);displayUsers(arrayOfUsers),hideModal(),displayDeactivated(deactivatedList),hideModal()}getJSON();
